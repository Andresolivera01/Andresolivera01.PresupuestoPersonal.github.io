<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <title>Presupuesto Personal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS externo -->
    <link rel="stylesheet" href="styles.css">

    <!-- Librerías externas para gráficas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>

  </head>
  
 <body>

<header>
  <h1>Presupuesto Personal</h1>
  <div class="saldos" id="headerSaldos"></div>
</header>

<!-- GRID SUPERIOR -->
<div class="grid-superior">
  <!-- FORM -->
  <div class="col col1-small">
    <h3 style="margin:0 0 5px 0;">Nuevo Movimiento</h3>
    <div class="row row-column" style="gap:3px;">
      <select id="type"><option value="ingreso">Ingreso</option><option value="fijo">Gasto Fijo</option><option value="variable">Gasto Variable</option></select>

      <select id="category"><option value="">-- Categoría --</option></select>

      <input id="amount" type="number" placeholder="Monto">
      <input id="desc" placeholder="Descripción">
      <input id="date" type="date">

      <div style="display:flex; gap:8px; align-items:center;">
        <select id="currency" style="flex:1;">
          <option value="EUR">€ Euro</option>
          <option value="USD">$ Dólar</option>
          <option value="COP">$ COP</option>
        </select>
        <span id="trmLabel" style="display:inline-block; align-self:center;">TRM</span>
        <input id="trm" type="number" placeholder="TRM" value="1" style="width:50px;">
        <button id="add" style="flex:1;">Agregar</button>

      </div>

   

    
    </div>

    <hr style="border:0;border-top:1px solid #151515;margin:10px 0;">
    <h4 style="margin:0 0 6px 0;">Checklist Obligaciones</h4>

   	<div style="display:flex; gap:8px; align-items:center; margin-bottom:6px;">
  	<label style="font-size:0.95em;">Mes:</label>
  	<input type="month" id="checkMonthTop" value="">
	</div>

	<div style="display:flex; gap:8px; margin-bottom:6px;">
  	<button id="addCheckItemTop" style="padding:6px 10px;">+ Item</button>
  	<button id="resetChecklistTop" style="padding:6px 10px; background:#ff6b6b; color:white;">Reiniciar</button>
	</div>

    <div id="checklistContainerTop"></div>
  </div>

  <!-- GASTOS POR CATEGORIA -->
  <div class="col">
    <h3 style="margin:0 0 8px 0;">Gastos por Categoría</h3>
    <div class="row" style="align-items:center;">
      <label style="font-size:0.95em;">Mes: <input type="month" id="monthPicker"></label>
      <label style="font-size:0.95em;">Año:
        <select id="yearSelector"></select>
      </label>
      <label style="font-size:0.95em;">Ver:
        <select id="viewSelector"><option value="mes">Mes</option><option value="año">Año</option></select>
      </label>
    </div>
    <canvas id="chartCategorias" class="col3canvas"></canvas>
  </div>

  <!-- CASHFLOW -->
  <div class="col">
    <h3 style="margin:0 0 8px 0; display:flex; align-items:center; gap:12px;">
      Cashflow
      <div style="margin-left:auto; display:flex; align-items:center;">
        <button id="cashByYear" class="smallBtn toggleOn" title="Cashflow por año (mensual)">Por año</button>
        <button id="cashByMonth" class="smallBtn toggleOff" title="Cashflow por mes (por días)">Por mes</button>
      </div>
    </h3>
    <canvas id="chartAnual" class="col3canvas"></canvas>
    <h4 style="margin:10px 0 6px 0;">Ahorros e Inversiones</h4>
    <canvas id="chartAhorro" class="col3canvas"></canvas>
  </div>
</div>

<div style="height:10px;margin:0 1cm;"></div>

<!-- SECCION INFERIOR -->
<div class="grid-inferior">
  <div class="col" id="resumenContainer">
    <h3 style="margin:0 0 10px 0;">Resumen Anual</h3>
    <table id="tablaResumen">
      <thead>
	<tr>
	<th>Mes</th>
	<th>Ingresos</th>
	<th>Gastos</th>
	<th>Saldo Mes</th>
	<th>Saldo Total</th>
	</tr>
	</thead>

      <tbody></tbody>
      <tfoot><tr><th>Total</th><th id="totalIngresos"></th><th id="totalGastos"></th><th id="totalSaldo"></th></tr></tfoot>
    </table>
  </div>

  <div class="col" id="movimientosContainer">
    <div id="movimientosHeader">
      <h3>Histórico de Movimientos</h3>
      <div class="row" style="flex-wrap:wrap; gap:6px;">
        <select id="filterType"><option value="">Todos los tipos</option><option value="ingreso">Ingreso</option><option value="fijo">Gasto Fijo</option><option value="variable">Gasto Variable</option></select>
        <select id="filterCategory"><option value="">Todas las categorías</option></select>
        <input type="date" id="filterDateFrom" placeholder="Desde">
        <input type="date" id="filterDateTo" placeholder="Hasta">
        <input type="number" id="filterMinAmount" placeholder="Min" style="width:50px;">
        <input type="number" id="filterMaxAmount" placeholder="Max" style="width:50px;">
        <input type="text" id="filterDesc" placeholder="Buscar descripción" style="flex:1; min-width:10px;">
      </div>

      <div id="filtroTotales" aria-live="polite">
  <span id="filtroTotalIngresos">Ingresos: €0</span>
  <span id="filtroTotalGastos">Gastos: €0</span>
  <span id="filtroTotalNeto">Neto: €0</span>

  
  <!-- BOTÓN RESET FILTROS -->
  <button onclick="resetFiltros()" 
          style="padding:6px 10px; margin:15px; background:#333; border:1px solid #555; border-radius:6px; color:white;">
    Restablecer
  </button>

<!-- BOTÓN DE SELECCION -->
<button id="toggleSelect" 
        style="padding:6px 10px; margin-left:auto; background:#444; border:1px solid #666; border-radius:6px; color:white;">
  Seleccionar/Deseleccionar
</button>

</div>

    </div>

    <div id="movimientosBody">
      <table>
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Tipo</th>
            <th>Categoría</th>
            <th>Monto</th>
	    <th>Saldo</th>
            <th>Detalle</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="list"></tbody>
      </table>
    </div>
  </div>
</div>


<div class="footer">Andres F. Olivera Presupuesto Personal</div>

<!-- Modal editar -->
<div id="editModal">
  <div class="modal-content">
    <h3 style="margin-top:0;">Editar Movimiento</h3>
    <div class="row row-column" style="gap:3px;">
      <select id="editType"></select>
      <select id="editCategory"></select>
      <input id="editAmount" type="number" placeholder="Monto">
      <input id="editDesc" placeholder="Descripción">
      <input id="editDate" type="date">
      <div style="display:flex; gap:8px; align-items:center;">
        <select id="editCurrency" style="flex:1;">
          <option value="EUR">€ Euro</option>
          <option value="USD">$ Dólar</option>
          <option value="COP">$ COP</option>
        </select>
        <input id="editTrm" type="number" placeholder="TRM" style="width:100px;">
      </div>
      <div style="display:flex; gap:8px; margin-top:8px;">
        <button id="saveEdit" style="flex:1;">Guardar</button>
        <button id="cancelEdit" style="flex:1;">Cancelar</button>
      </div>
    </div>
  </div>
</div>

<!-- Tu script principal -->
<script src="script.js" defer></script>
</body>
</html>